---
title: 关系型数据库设计
author: lijiabao
date: 2021-05-11 23:30
categories: ["MySQL", "Database"]
tags: ["MySQL", "Database"]
---

主要介绍一下数据库设计的三大范式和反范式，以及数据库设计的基本步骤

# 数据库设计

## 数据库三大范式

### 数据库第一范式

数据库表中的每一个字段都是不可再分的，需要保证每一个字段的原子性
| 订单编号 | 订单日期   | 订单金额 | 订单客户 | 订单客户注册日期 | 订单用户地址 |
| -------- | ---------- | -------- | -------- | ---------------- | --------|
| 001      | 2021-05-11 | 250      | 李佳宝   | 2016-06-15       |湖南，邵阳 |
| 002      | 2021-05-11 | 240      | 李万机   | 2020-07-08       | 湖南，衡阳 |
| 003      | 2021-05-12 | 305      | 王递归   | 2021-05-15       |安徽，安庆 |

像上面的表就不满足字段的原子性，不满足字段的不可再分，因此需要再对订单用户地址进行细分：
| 订单编号 | 订单日期   | 订单金额 | 订单客户 | 订单客户注册日期 | 订单用户省份 | 订单用户所在市 |
| -------- | ---------- | -------- | -------- | ---------------- | --------| -------- |
| 001      | 2021-05-11 | 250      | 李佳宝   | 2016-06-15       |湖南 | 邵阳 |
| 002      | 2021-05-11 | 240      | 李万机   | 2020-07-08       | 湖南 | 衡阳 |
| 003      | 2021-05-12 | 305      | 王递归   | 2021-05-15       |安徽 | 安庆 |


### 数据库第二范式

数据库表中的每一个字段需要和表有依赖关系
| 订单编号 | 订单日期   | 订单金额 | 订单客户 | 订单客户注册日期 | 订单用户省份 | 订单用户所在市 |
| -------- | ---------- | -------- | -------- | ---------------- | --------| -------- |
| 001      | 2021-05-11 | 250      | 李佳宝   | 2016-06-15       |湖南 | 邵阳 |
| 002      | 2021-05-11 | 240      | 李万机   | 2020-07-08       | 湖南 | 衡阳 |
| 003      | 2021-05-12 | 305      | 王递归   | 2021-05-15       |安徽 | 安庆 |

上述的表中，和明显订单用户的省份和所在市和订单编号没有直接的依赖关系，因此可以将着两个字段单独放在一个表中，以满足第二范式。

| 订单编号 | 订单日期   | 订单金额 | 订单客户 |
| -------- | ---------- | -------- | -------- |
| 001      | 2021-05-11 | 250      | 李佳宝   |
| 002      | 2021-05-11 | 240      | 李万机   |
| 003      | 2021-05-12 | 305      | 王递归   |

| 订单客户 | 订单用户注册日期 | 订单用户省份 | 订单用户所在市 |
| -------- | ---------------- | --------| -------- |
| 李佳宝   | 2016-06-15       |湖南 | 邵阳 |
| 李万机   | 2020-07-08       | 湖南 | 衡阳 |
| 王递归   | 2021-05-15       |安徽 | 安庆 |

### 数据库第三范式

数据库的每一个字段需要和表的主键有直接依赖关系

| 订单编号 | 订单日期   | 订单金额 | 订单客户 | 订单客户注册日期 |
| -------- | ---------- | -------- | -------- | ---------------- |
| 001      | 2021-05-11 | 250      | 李佳宝   | 2016-06-15       |
| 002      | 2021-05-11 | 240      | 李万机   | 2020-07-08       |
| 003      | 2021-05-12 | 305      | 王递归   | 2021-05-15       |

像上述的表中，订单客户注册日期和订单编号就没有直接的依赖关系，因此需要将订单客户和订单客户注册日期单独放在一个表中，因此需要像下面操作一样将上述的表拆分为两个表

| 订单编号 | 订单日期   | 订单金额 | 订单客户 |
| -------- | ---------- | -------- |--------|
| 001      | 2021-05-11 | 250      |李佳宝|
| 002      | 2021-05-11 | 240      |李万机 |
| 003      | 2021-05-12 | 305      |王递归 |

| 订单客户 | 订单客户注册日期 |
| -------- | ---------- |
| 李佳宝      | 2021-05-11 |
| 李万机   | 2021-05-11 |
| 王递归   | 2021-05-12 |

## 数据库反范式

有的时候，为了保证数据库的性能，需要故意的增加冗余字段，从而可以减少联表的数量，或者减少数据的迭代次数，从而提高数据查询时的性能。

反范式的做法：在概念数据模型设计时遵守第三范式，降低范式标准的工作放到物理数据模型设计时考虑。降低范式的就是增加字段，减少查询时的关联，从而提高查询的效率。因为数据库操作中的主要操作还是查询比例更大，反范式一定要适度，并且需要在满足三范式的基础上进行。

### 反范式的优点

- 可以避免联表查询
- 可以设计高效查找的索引

### 反范式的缺点

- 表中的冗余数据较多，删除数据时可能造成表中有效信息的丢失



## 数据库范式优缺点

### 优点

- 范式化的数据库更新起来更加快
- 范式化之后，只有少量的重复数据，只需要修改很少的数据
- 范式化的表更小，可以直接在内存中执行
- 冗余数据更少，查询的时候只需要很少的distict或者group by语句

### 缺点

- 范式化的表，查询时往往需要更多的联表查询
- 因为单独的表中不存在冗余和重复数据，稍微复杂的查询语句就需要进行联表查询，会增加查询的代价
- 除了查询代价昂贵，也有可能导致不可使用索引，导致查询效率降低

## 数据库设计步骤

1. 标识表的设计：首先对整个的框架进行表的设计，将所有的数据依存的表先设计好
2. 表中字段的设计：在遵守三大范式的基础上设计表中的字段
3. 表和表之间的关联：表之间的互联字段设计的考虑

